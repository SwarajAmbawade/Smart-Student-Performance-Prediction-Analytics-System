<!DOCTYPE html>
<html>
<head>
    <title>Analytics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        /* Override body for dashboard to allow scrolling if needed */
        body { display: block; padding: 60px 0; }
        h2 { color: white; text-align: center; margin-bottom: 40px; font-size: 2rem; }
    </style>
</head>
<body>

    <div class="project-header">STUDENT AI PREDICTOR</div>

    <h2>Global Student Analytics</h2>

    <div class="dashboard-container">
        <div class="chart-box" style="animation: fadeInUp 0.6s ease forwards;">
            <h3 style="margin-top:0">Grade Distribution</h3>
            <canvas id="gradeChart"></canvas>
        </div>

        <div class="chart-box" style="animation: fadeInUp 0.8s ease forwards;">
            <h3 style="margin-top:0">Pass/Fail Ratio</h3>
            <canvas id="statusChart"></canvas>
        </div>

        <div class="chart-box" style="grid-column: span 1; animation: fadeInUp 1s ease forwards;">
             <h3 style="margin-top:0">Correlation: Attendance vs Confidence</h3>
            <canvas id="scatterChart"></canvas>
        </div>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
        <a href="/" class="btn" style="width: auto; padding: 12px 40px;">Back to Predictor</a>
    </div>

<script>
    const grades = {{ grades | tojson }};
    const status = {{ status | tojson }};
    const attendance = {{ attendance | tojson }};
    const probability = {{ probability | tojson }};

    // Grade Distribution
    new Chart(document.getElementById('gradeChart'), {
        type: 'doughnut',
        data: {
            labels: Object.keys(grades),
            datasets: [{
                data: Object.values(grades),
                backgroundColor: ['#4f46e5', '#7c3aed', '#ec4899', '#f59e0b', '#10b981']
            }]
        }
    });

    // Pass vs Fail
    new Chart(document.getElementById('statusChart'), {
        type: 'bar',
        data: {
            labels: Object.keys(status),
            datasets: [{
                label: 'Count',
                data: Object.values(status),
                backgroundColor: ['#10b981', '#ef4444']
            }]
        }
    });

    // Attendance vs Probability
    new Chart(document.getElementById('scatterChart'), {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'Student Data Points',
                data: attendance.map((a, i) => ({
                    x: a,
                    y: probability[i]
                })),
                backgroundColor: '#7c3aed'
            }]
        },
        options: {
            scales: {
                x: { title: { display: true, text: 'Attendance (%)' }},
                y: { title: { display: true, text: 'Confidence (%)' }}
            }
        }
    });
</script>

</body>
</html>
